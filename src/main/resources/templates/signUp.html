<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/login.css}">
    <title>Sign Up</title>
    <link rel="icon" type="image/png" th:href="@{/images/tts-logo-removebg-preview.png}">
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />

    <style>

        .form-container {
            margin-top: 2rem;
        }

                /* ===== Guidelines Icon ===== */
        .signup-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 15px;
        }

        /* ===== Info Icon ===== */
        .info-icon {
          position: absolute;
          top: 20px;
          right: 25px;
          font-size: 24px;
          color: var(--color, #007bff);
          cursor: pointer;
          animation: pulse 1.8s infinite;
          transition: transform 0.2s ease;
        }

        .info-icon:hover {
          transform: scale(1.1);
          color: #0056b3;
        }

        @keyframes pulse {
          0% { opacity: 1; transform: scale(1); }
          50% { opacity: 0.6; transform: scale(1.1); }
          100% { opacity: 1; transform: scale(1); }
        }

        /* ===== Modal Overlay ===== */
        .modal {
          display: none;
          position: fixed;
          inset: 0;
          background-color: rgba(0, 0, 0, 0.55);
          backdrop-filter: blur(5px);
          justify-content: center;
          align-items: center;
          z-index: 9999;
        }

        /* ===== Modal Content ===== */
        .modal-content {
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(15px);
          border-radius: 15px;
          padding: 25px 35px;
          width: fit-content
          max-width: 90%;
          color: #fff;
          font-family: 'Poppins', sans-serif;
          text-shadow: 0 1px 2px rgba(0,0,0,0.2);
          box-shadow: 0 10px 30px rgba(0,0,0,0.3);
          animation: fadeIn 0.4s ease, scaleIn 0.3s ease;
        }

        .modal-content h2 {
          font-size: 22px;
          margin-bottom: 15px;
          display: flex;
          align-items: center;
          gap: 10px;
          border-bottom: 1px solid rgba(255,255,255,0.2);
          padding-bottom: 8px;
        }

        .modal-content i {
          color: #ffcc00;
        }

        .guidelines-list {
          list-style: none;
          padding: 0;
          margin: 15px 0 0;
        }

        .guidelines-list li {
          margin: 10px 0;
          line-height: 1.4;
          display: flex;
          align-items: flex-start;
          gap: 8px;
          color: #f0f0f0;
        }

        .guidelines-list li i {
          color: #00d4ff;
          flex-shrink: 0;
          margin-top: 2px;
        }

        /* ===== Close Button ===== */
        .close {
          position: absolute;
          top: 15px;
          right: 20px;
          font-size: 26px;
          color: #fff;
          cursor: pointer;
          transition: color 0.2s;
        }

        .close:hover {
          color: #ff6666;
        }

        /* ===== Animations ===== */
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes scaleIn {
          from { transform: scale(0.9); }
          to { transform: scale(1); }
        }

    </style>

</head>
<body>
<section class="container">
    <div class="login-container" style="margin-top:20px;">
        <div class="circle circle-one"></div>

        <!-- Guidelines Modal -->
        <div id="guidelinesModal" class="modal">
            <div class="modal-content">
                <span class="close" id="closeModal">&times;</span>
                <h2><i class="fa-solid fa-clipboard-check"></i> Signup Guidelines</h2>

                <ul class="guidelines-list" style="list-style-type: circle; ">
                    <li><strong>Full Name:</strong> Only letters and spaces (3–100 characters).</li>
                    <li><strong>Username:</strong> 4–50 characters. Letters, numbers, and underscores only.</li>
                    <li><strong>Email:</strong> Must be a valid and unique email address.</li>
                    <li><strong>Password:</strong> Minimum 8 characters, including uppercase, lowercase, digit, and special character.</li>
                    <li><strong>Confirm Password:</strong> Must exactly match your password.</li>
                    <li><strong>Admin Code:</strong> Required only if you select the <em>ADMIN</em> role.</li>
                    <li><strong>Role:</strong> Choose your role carefully — <em>USER</em> or <em>ADMIN</em>.</li>
                </ul>

                <p class="note">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <strong>Note:</strong> This signup service is currently available <em>only for Administrators</em> on a temporary basis.
                </p>
            </div>
        </div>

        <div class="form-container">
            <!-- Header -->
            <div class="signup-header">
            <h2 class="opacity" style="text-align:center;">SIGN UP</h2>
            <i class="fa-solid fa-circle-info info-icon" id="guidelinesBtn" title="View Form Guidelines"></i>
        </div>

            <!-- Sign Up Form -->
            <form th:action="@{/signup}" method="post">

                <input type="text" name="fullName" placeholder="FULL NAME" required/>
                <input type="text" name="username" placeholder="USERNAME" required/>
                <input type="email" name="email" placeholder="EMAIL" required/>
                <input type="password" name="password" placeholder="PASSWORD" required/>
                <input type="password" name="confirmPassword" placeholder="CONFIRM PASSWORD" required/>

                <!-- Role Selection -->
                <div class="input-group">
                    <label for="role">Select Role</label>
                    <select id="role" name="role" required>
                        <option value="USER" selected>USER</option>
                        <option value="ADMIN">ADMIN</option>
                    </select>
                </div>

                <!-- Admin Code (hidden unless ADMIN selected) -->
                <div class="input-group" id="adminCodeGroup" style="display:none;">
                    <label for="adminCode">Admin Code</label>
                    <input type="text" id="adminCode" name="adminCode" placeholder="Enter Admin Code"/>
                </div>

                <button type="submit" class="opacity">SIGN UP</button>

                <!-- Message container -->
                <div th:if="${error}" class="error-message" style="color:red;">
                    <span th:text="${error}"></span>
                </div>

                <div th:if="${success}" class="success-message" style="color:green;">
                    <span th:text="${success}"></span>
                </div>
            </form>

            <!-- Links -->
            <div class="register-forget opacity">
                <a th:href="@{/login(role='ADMIN')}">Back to Login</a>
            </div>

        </div>
        <div class="circle circle-two"></div>
    </div>
</section>

<!-- Support Modal -->
<div>
    <div class="support-modal hidden" id="supportModal" role="dialog" aria-modal="true"
         aria-labelledby="supportModalTitle" aria-describedby="supportModalDescription" tabindex="-1">
        <div class="support-modal__header">
            <h2 id="supportModalTitle">Need Assistance?</h2>
            <button type="button" class="support-modal__close js-support-close" aria-label="Close support modal">&times;</button>
        </div>
        <div class="support-modal__content">
            <p id="supportModalDescription">We’re here to help. Reach out using the contact details below.</p>
            <div class="support-modal__contact">
                <a href="mailto:arbaaz@tts.net.in">arbaaz@tts.net.in</a>
                <a href="tel:+919371044424">+91 93710 44424</a>
            </div>
        </div>
    </div>
    <div class="modal-backdrop hidden" id="supportModalBackdrop"></div>
</div>

<script th:src="@{/js/login.js}"></script>
<script>
// Modal functionality for guidelines
           document.getElementById('guidelinesBtn').addEventListener('click', () => {
      document.getElementById('guidelinesModal').style.display = 'flex';
    });

    document.getElementById('closeModal').addEventListener('click', () => {
      document.getElementById('guidelinesModal').style.display = 'none';
    });

    window.addEventListener('click', (e) => {
      const modal = document.getElementById('guidelinesModal');
      if (e.target === modal) modal.style.display = 'none';
    });

// Show/hide admin code input based on role selection
    const roleSelect = document.getElementById('role');
    const adminCodeGroup = document.getElementById('adminCodeGroup');

    roleSelect.addEventListener('change', function() {
        if(this.value === 'ADMIN') {
            adminCodeGroup.style.display = 'block';
        } else {
            adminCodeGroup.style.display = 'none';
        }
    });


</script>
</body>
</html>
